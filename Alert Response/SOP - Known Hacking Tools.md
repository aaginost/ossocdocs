## Purpose
This Standard Operating Procedure (SOP) outlines the process for responding to alerts or detections of known hacking tools within the environment. Known hacking tools—such as Mimikatz, Responder, Metasploit, or Cobalt Strike—are not used for legitimate IT purposes and indicate potential active threat actor activity. This document provides guidance on immediate escalation to the Incident Response (IR) team, as well as contextual analysis for tools that may have dual use, such as nmap, Purple Knight, Sysinternals Suite, or Wireshark.

## Scope
This SOP applies to all personnel within the SOC, including SOC analysts, incident responders, and relevant IT security teams. It covers the identification, analysis, and escalation procedures for both confirmed detections of known hacking tools and ambiguous alerts that require further contextualization. It is intended for use in environments where non-native tools are not pre-installed, ensuring that any installation or execution of such tools is thoroughly investigated.

## Prerequisites
- **Monitoring and Detection Systems:** Ensure that all intrusion detection systems (IDS), endpoint detection and response (EDR) tools, and log management systems are configured to detect signatures or behaviors associated with known hacking tools.
- **Baseline Environment Knowledge:** Maintain an up-to-date inventory of authorized software and tools used by legitimate administrators to distinguish between sanctioned and unauthorized tool use.
- **User Account Context:** Ensure that logging and audit trails for user account activities are in place, allowing for tracing the source of tool installations or executions.
- **Training:** All SOC personnel must be trained on identifying indicators of compromise (IoCs) related to known hacking tools and the proper escalation process.

## Roles and Responsibilities

| Role        | Responsibility                                                                                                                                                                                                                                                                                                                                                                                                               |
| ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SOC Analyst | Monitor and triage alerts generated by detection systems.<br>Conduct initial analysis to determine the legitimacy of tool usage.<br>Gather contextual information regarding the user account and installation pathways when tools with potential dual use (e.g., nmap, Sysinternals Suite) are detected.<br>Escalate validated detections of known hacking tools (e.g., Mimikatz, Cobalt Strike) immediately to the IR team. |
| SOC Manager | Oversee SOC operations and ensure adherence to this SOP.<br>Facilitate communication between SOC, IR, and other relevant stakeholders.<br>Review and update the SOP periodically to reflect evolving threat landscapes and toolsets.                                                                                                                                                                                         |
| IR Team     | Receive escalations from the SOC and conduct in-depth investigations.<br>Determine the scope, impact, and remediation steps for incidents involving known hacking tools.<br>Coordinate with other IT security teams to contain and remediate threats.                                                                                                                                                                        |

## Workflow Diagram
[Insert visual diagram of the SOP workflow]

## Procedure Steps

### 1. Ticket and Tracking
* Create a ticket for tracking.

### 2. Alert Reception and Initial Triage:

- **Receive Alert:** SOC analysts monitor alerts from detection systems.
   - **Preliminary Analysis:** Confirm if the detected tool is a known hacking tool (e.g., Mimikatz, Metasploit, etc.) or a tool that may have legitimate use (e.g., nmap, Wireshark).
   - **Document Details:** Record alert details, including timestamp, affected systems, and associated user accounts.

### 3. Contextual Investigation:
   
   - **Legitimacy Check:** For tools that can have dual use (e.g., nmap, Purple Knight):
       - Identify the user account responsible.
       - Verify installation pathways and historical usage patterns.
       - Determine whether the tool aligns with sanctioned administrative activities.
   - **Threat Determination:** If the tool is one that is not legitimate (i.e., not typically used by IT administration) or if there is any indication of misuse, classify the detection as a high-risk alert.

### 4. Escalation:
   
   - **Immediate Notification:** For validated detections of non-legitimate hacking tools:
       - Immediately escalate the incident to the IR team.
       - Provide all contextual details and supporting logs to assist with the investigation.
   - **Document Escalation:** Log the escalation event in the incident management system, including the rationale for the decision and any relevant user account or system details.

### 5. Containment and Remediation:
   
   - **Coordination with IR:** Assist the IR team in containing the threat by isolating affected systems if necessary.
   - **User Notification:** If appropriate, notify the account owner pending further investigation and confirm whether the tool usage was authorized.
   - **Mitigation Steps:** Follow established IR procedures for remediation, which may include system isolation, password resets, and vulnerability patching.

### 6. Post-Incident Review:
   
   - **Incident Documentation:** Ensure all investigative findings, containment actions, and remediation steps are thoroughly documented.
   - **Lessons Learned:** Conduct a post-incident review with SOC and IR teams to identify gaps in detection or response procedures.
   - **SOP Update:** If necessary, update this SOP and any related procedures to improve future detection and response capabilities.